{
  "name" : "janus-app",
  "image" : "mcr.microsoft.com/devcontainers/base:ubuntu",
  "customizations" : {
    "vscode" : {
      "extensions" : [
        "hverlin.mise-vscode",
        "scala-lang.scala"
      ]
    },
    "jetbrains" : {
      "plugins" : [
        "com.github.l34130.mise",
        "org.intellij.scala",
        "NodeJS"
      ]
    }
  },
  "forwardPorts" : [
    9100, 1234
  ],
  "features" : {
    "ghcr.io/devcontainers/features/docker-in-docker:2" : {
      "version" : "latest",
      "moby" : true,
      "dockerDashComposeVersion" : "v2"
    }
  },
  "mounts" : [
    {
      "source" : "docker-mise-data-volume",
      "target" : "/mnt/mise-data",
      "type" : "volume"
    },
    "source=${localEnv:HOME}/.gu/janus-app,target=/home/vscode/.gu/janus-app,readonly,type=bind,consistency=cached"
  ],
  "containerEnv" : {
    "JAVA_HOME": "/mnt/mise-data/installs/java/corretto-21",
    "MISE_DATA_DIR" : "/mnt/mise-data"
  },
  "remoteEnv" : {
    "PATH" : "/mnt/mise-data/shims:${containerEnv:PATH}"
  },
  "capAdd" : [
    "SYS_ADMIN"
  ],
  "securityOpt" : [
    "seccomp=unconfined"
  ],
  "postCreateCommand" : "(cd . && bash -c 'set -e && echo -e \"\\033[1;34m[setup] Setting up mise...\\033[0m\" && sudo chown -R vscode:vscode /mnt/mise-data && curl -fsSL https://mise.run/bash | sh && sudo ln -sf /home/vscode/.local/bin/mise /usr/local/bin/mise && mise --version && mise trust --yes || true && (mise install || echo -e \"\\033[1;33m[setup] mise install failed. You may need to run mise install manually inside the container.\\033[0m\") && mise doctor && echo -e \"\\033[1;32m[setup] mise setup complete.\\033[0m\"')",
  "postStartCommand": "git config --global --add safe.directory /IdeaProjects/janus-app || git config --global --add safe.directory /workspaces/janus-app"

}