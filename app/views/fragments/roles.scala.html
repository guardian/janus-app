@import com.gu.janus.model.Role
@import logic.Customisation.displayColour
@import models.DisplayMode
@import models.DisplayMode.*

@(roles: List[Role], displayMode: DisplayMode = Normal)

@if(roles.isEmpty) {
    <div class="card grey lighten-4">
        <div class="card-content">
            <span class="card-title grey-text text-darken-2">No role-based access</span>
            <p class="grey-text">You don't currently have any role-based permissions assigned.</p>
        </div>
    </div>
} else {
    @for(role <- roles) {
        <div class="card card--role @displayColour(displayMode) lighten-5">
            <div class="card-content card-content--role-header @displayColour(displayMode) darken-4 white-text">
                <span class="card-title">@role.name</span>
            </div>
            <div class="role-body">
                @for(permission <- role.permissions) {
                    <div class="card-content card-content--permission-heading">
                        <p>
                            <strong>@permission.account.name:</strong> @permission.description
                            @if(permission.shortTerm) {
                                <i class="material-icons tooltipped" data-position="bottom" data-delay="50" data-tooltip="This permission only grants short-term access">error</i>
                            }
                        </p>
                    </div>
                    <div class="card-action card-action--permission">
                        <div class="card-action-group__row row">
                            <div class="card-action-group col m6 s12">
                                <a href="/console?permissionId=@permission.id"
                                   class="waves-effect waves-light btn federation__link federation__link--cta federation__link--@if(permission.shortTerm) {short} else {standard} card-action-link--spaced"
                                >
                                    <i class="material-icons">cloud</i>
                                </a>
                                <a href="/consoleUrl?permissionId=@permission.id"
                                   class="right waves-effect waves-light btn-flat federation__link janus-btn--flat card-action-link--tight federation__link--@if(permission.shortTerm) {short} else {standard}"
                                >
                                    <i class="material-icons black-text">link</i>
                                </a>
                            </div>
                            <div class="card-action-group card-action-group--divider col m6 s12">
                                <a href="/credentials?permissionId=@permission.id"
                                   class="waves-effect waves-light btn federation__link federation__link--cta federation__link--credentials federation__link--@if(permission.shortTerm) {short} else {standard}"
                                >
                                    <i class="material-icons">vpn_key</i>
                                </a>
                                @if(!permission.shortTerm) {
                                    <div class="multi-select__container right">
                                        <label class="multi-select__label">
                                            <input class="multi-select__checkbox" type="checkbox" name="@permission.id" id="@permission.id" data-permission-id="@permission.id">
                                            <span></span>
                                        </label>
                                    </div>
                                }
                            </div>
                        </div>
                    </div>
                }
            </div>
        </div>
    }
}
